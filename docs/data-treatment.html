<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A brief introduction to QGIS</title>
  <meta name="description" content="This is a a brief introduction to QGIS.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="A brief introduction to QGIS" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a a brief introduction to QGIS." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A brief introduction to QGIS" />
  
  <meta name="twitter:description" content="This is a a brief introduction to QGIS." />
  

<meta name="author" content="Ivan Viveros Santos">


<meta name="date" content="2019-09-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="loading-and-exporting-data.html">
<link rel="next" href="data-preprocessing-steps.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A brief introduction to QGIS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> QGIS installation and Graphical User Interface</a><ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#qgis-installation"><i class="fa fa-check"></i><b>2.1</b> QGIS installation</a></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#qgis-graphical-user-interface"><i class="fa fa-check"></i><b>2.2</b> QGIS Graphical User Interface</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="loading-and-exporting-data.html"><a href="loading-and-exporting-data.html"><i class="fa fa-check"></i><b>3</b> Loading and Exporting data</a><ul>
<li class="chapter" data-level="3.1" data-path="loading-and-exporting-data.html"><a href="loading-and-exporting-data.html#importing-data-from-text-files"><i class="fa fa-check"></i><b>3.1</b> Importing data from text files</a></li>
<li class="chapter" data-level="3.2" data-path="loading-and-exporting-data.html"><a href="loading-and-exporting-data.html#importing-data-from-kml-files"><i class="fa fa-check"></i><b>3.2</b> Importing data from KML files</a></li>
<li class="chapter" data-level="3.3" data-path="loading-and-exporting-data.html"><a href="loading-and-exporting-data.html#importing-geojson-files"><i class="fa fa-check"></i><b>3.3</b> Importing GeoJSON files</a></li>
<li class="chapter" data-level="3.4" data-path="loading-and-exporting-data.html"><a href="loading-and-exporting-data.html#saveLayer"><i class="fa fa-check"></i><b>3.4</b> Saving a layer</a></li>
<li class="chapter" data-level="3.5" data-path="loading-and-exporting-data.html"><a href="loading-and-exporting-data.html#reprojecting-a-layer"><i class="fa fa-check"></i><b>3.5</b> Reprojecting a layer</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-treatment.html"><a href="data-treatment.html"><i class="fa fa-check"></i><b>4</b> Data treatment</a><ul>
<li class="chapter" data-level="4.1" data-path="data-treatment.html"><a href="data-treatment.html#joining-layer-data"><i class="fa fa-check"></i><b>4.1</b> Joining layer data</a></li>
<li class="chapter" data-level="4.2" data-path="data-treatment.html"><a href="data-treatment.html#cleaning-up-the-attribute-table"><i class="fa fa-check"></i><b>4.2</b> Cleaning up the attribute table</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-preprocessing-steps.html"><a href="data-preprocessing-steps.html"><i class="fa fa-check"></i><b>5</b> Data preprocessing steps</a><ul>
<li class="chapter" data-level="5.1" data-path="data-preprocessing-steps.html"><a href="data-preprocessing-steps.html#clipping-vectors"><i class="fa fa-check"></i><b>5.1</b> Clipping vectors</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>6</b> Data exploration</a><ul>
<li class="chapter" data-level="6.1" data-path="data-exploration.html"><a href="data-exploration.html#listing-unique-values-in-a-column"><i class="fa fa-check"></i><b>6.1</b> Listing unique values in a column</a></li>
<li class="chapter" data-level="6.2" data-path="data-exploration.html"><a href="data-exploration.html#basemaps"><i class="fa fa-check"></i><b>6.2</b> Loading BaseMaps</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>7</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A brief introduction to QGIS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-treatment" class="section level1">
<h1><span class="header-section-number">Section 4</span> Data treatment</h1>
<div id="joining-layer-data" class="section level2">
<h2><span class="header-section-number">4.1</span> Joining layer data</h2>
<p>Another frequent task before executing spatial analysis with QGIS is to join an attribute table to a layer.</p>
<p>To illustrate this task, we refer to the <code>stations_rsqa.shp</code> file generated in section 1 and the file <code>pollutants_average_12_31_2019_13H.csv</code> file. When we load the shapefile into QGIS we identify that this layer only contains information on the identification and location of stations that compose the Air Quality Monitoring Network (RSQA).</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-12"></span>
<img src="figures/Change_Encoding.png" alt="Attribute table of stations_rsqa layer" width="556" />
<p class="caption">
Figure 4.1: Attribute table of stations_rsqa layer
</p>
</div>
<p>We realize another problem, the name (nom) and the address of the stations are not correctly displayed. In order to fix it, right-click on the name of the layer, and select properties. A window will pop up. Go to <strong>Source</strong> and change the <strong>Data Source Encoding</strong> to <strong>UTF-8</strong>. Finally, click on Apply to accept the changes.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<img src="figures/Change_Encoding_2.png" alt="Changing encoding" width="460" />
<p class="caption">
Figure 4.2: Changing encoding
</p>
</div>
<p>Now, import the <code>pollutants_average_12_31_2019_13H.csv</code> file. One kick method is to drag and drop the file from the file into QGIS. This works fine for this file; however, you also can use <strong>Add Delimited Text Layer</strong> to have more control on the importation.</p>
<p>The <code>pollutants_average_12_31_2019_13H.csv</code> file reports the average concentration of criteria pollutants from December 23, 2013, at 12h. The units of concentration are indicated in the following table.</p>
<table>
<thead>
<tr class="header">
<th>Pollutant</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CO</td>
<td>ppm</td>
</tr>
<tr class="even">
<td>H<sub>2</sub>S</td>
<td>ppb</td>
</tr>
<tr class="odd">
<td>NO</td>
<td>ppb</td>
</tr>
<tr class="even">
<td>NO<sub>2</sub></td>
<td>ppb</td>
</tr>
<tr class="odd">
<td>SO<sub>2</sub></td>
<td><span class="math inline">\(\mu g/m^3\)</span></td>
</tr>
<tr class="even">
<td>PM<sub>10</sub></td>
<td><span class="math inline">\(\mu g/m^3\)</span></td>
</tr>
<tr class="odd">
<td>PM<sub>2.5</sub></td>
<td><span class="math inline">\(\mu g/m^3\)</span></td>
</tr>
<tr class="even">
<td>O<sub>3</sub></td>
<td>ppb</td>
</tr>
</tbody>
</table>
<p>In order to join the <code>pollutants_average_12_31_2019_13H</code> attribute table to the <code>stations_rsqa</code> layer, follow these steps:</p>
<ol style="list-style-type: decimal">
<li>Right-click on the name of <code>stations_rsqa</code> layer, select <strong>Properties</strong>, then <strong>Joins</strong> from the dialog window.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<img src="figures/Joins_Dialog_Box.png" alt="Layer properties window" width="476" />
<p class="caption">
Figure 4.3: Layer properties window
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Click on the green <strong>+</strong> sign. The following window will pop up:</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="figures/Joins_Dialog_Box_2.png" alt="Joining a layer table" width="262" />
<p class="caption">
Figure 4.4: Joining a layer table
</p>
</div>
<p>In this case, since we have imported only one attribute table, QGIS has already selected the Join layer.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Specify the <strong>Join field</strong> and the <strong>Target field</strong>, which correspond to the keys that relate the shapefile layer and the data layer. In this example, <strong>NO_POSTE</strong> is the identifier of the stations in the data layer and <strong>Numéro st</strong> is the identifier of the stations in the shapefile layer. Furthermore, it is possible to select the fields that will be joined, and the prefix that will be used. Since there are no repeated columns, we just deleted the default prefix, which corresponds to the name of the layer.</p></li>
<li><p>Click on <strong>OK</strong>, then on <strong>Apply</strong> to finish the joining.</p></li>
</ol>
<blockquote>
<p>To verify that the join has worked, you can open the attribute table of the shapefile. To make this change permanent, you need to export the layer. After the join, the layer was exported as <code>stations_rsqa_12_31_2013.shp</code>.</p>
</blockquote>
</div>
<div id="cleaning-up-the-attribute-table" class="section level2">
<h2><span class="header-section-number">4.2</span> Cleaning up the attribute table</h2>
<p>Sometimes, data imported into QGIS is not in the correct format, the name of columns is not self-explanatory, or we simply want to discard the columns that will not be used during the task in hand.</p>
<p>The <strong>Refactor fields</strong> algorithm simplifies removing, renaming and converting the format of dbf tables in QGIS. This algorithm ca be accessed through the <strong>Processing Toolbox</strong>. The use of <strong>Refactor fields</strong> is illustrated with the <code>stations_rsqa_12_31_2013.shp</code> file that was generated in the previous section.</p>
<ol style="list-style-type: decimal">
<li>Import <code>stations_rsqa_12_31_2013.shp</code> file</li>
<li>Launch the <strong>Refactor field</strong>. It will detect the available layer in the current project. In this window we can identify the name of columns, the type of information they store, their length and precision. The columns corresponding to concentrations, such as CO, H2S, and NO, are currently stored as text (data type is string). This is not convenient, since we cannot do arithmetic with text. Furthermore, we may want to change the name of <strong>Numéro st</strong> field for <strong>Station</strong>.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-16"></span>
<img src="figures/Refactor_Dialog.png" alt="Refactor field window" width="566" />
<p class="caption">
Figure 4.5: Refactor field window
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>We change the name of the first three columns according to the following figure, and the type of columns corresponding to concentrations was set as <strong>Double</strong> (real number) with a length of 23 and a precision of 3. Click on <strong>Run</strong> to generate a new layer.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-17"></span>
<img src="figures/Refactor_Dialog_Settings.png" alt="Using the refactor field algorithm" width="552" />
<p class="caption">
Figure 4.6: Using the refactor field algorithm
</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>The generated layer is named by default Refactored, of course, you can change its name at your convenience.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-18"></span>
<img src="figures/Refactor_Dialog_Settings_2.png" alt="Saving the refactored layer" width="318" />
<p class="caption">
Figure 4.7: Saving the refactored layer
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="loading-and-exporting-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-preprocessing-steps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-data_treatment.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
